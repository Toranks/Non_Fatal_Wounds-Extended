#textdomain wesnoth-Non_Fatal_Wounds

# this wound is only temporal, this unit is killed at the start of the next scenario, and is only visible when the unit speaks his last messages
#define NFW_dead_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [trait]
            id=nfw_dead
            male_name="<span color='#DA0000'>"+_"dead"+"</span>"
            female_name="<span color='#DA0000'>"+_"female^dead"+"</span>"
        [/trait]
    [/modify_unit]

    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Death" {NFW_COLOR_RED}}
#enddef

# same as death
#define NFW_plagued_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [trait]
            id=nfw_plagued
            male_name="<span color='#DA0000'>"+_"plagued"+"</span>"
            female_name="<span color='#DA0000'>"+_"female^plagued"+"</span>"
        [/trait]
    [/modify_unit]

    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Lost" {NFW_COLOR_RED}}
#enddef

#define NFW_destroyed_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [trait]
            id=nfw_dead
            male_name="<span color='#DA0000'>"+_"destroyed"+"</span>"
            female_name="<span color='#DA0000'>"+_"female^destroyed"+"</span>"
        [/trait]
    [/modify_unit]

    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Destruction" {NFW_COLOR_RED}}
#enddef

#define NFW_retreat_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
		[effect]
			apply_to=new_ability
			[abilities]
				[display]
					id=nfw_retreating
				[/display]
			[/abilities]
		[/effect]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Retreat" {NFW_COLOR_RED}}
#enddef

# one use wound, do not have any display
#define NFW_short_term_memory_loss_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [effect]
            apply_to=experience
            set=0
        [/effect]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Memory Loss" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_broken_arm_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=broken_arm
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=broken_arm_display
                        name="<span color='#DA0000'>"+_"broken arm"+"</span>"
                        description=_"Non-magical damage -30%"
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=attack
                [not]
                    special_id=magical
                [/not]
                increase_damage=-30%
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_broken_arm_Healing
                    description=_ "Recover from broken arm"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=broken_arm_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Broken Arm" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_broken_wing_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=broken_wing
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=broken_wing_display
                        name="<span color='#DA0000'>"+_"broken wing"+"</span>"
                        description=_"Movement points -40%"
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=movement
                increase=-40%
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_broken_wing_Healing
                    description=_ "Recover from broken wing"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=broken_wing_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Broken Wing" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_broken_leg_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=broken_leg
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=broken_leg_display
                        name="<span color='#DA0000'>"+_"broken leg"+"</span>"
                        description=_"Movement points -30%"
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=movement
                increase=-30%
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_broken_leg_Healing
                    description=_ "Recover from broken leg"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=broken_leg_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Broken Leg" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_broken_rib_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=broken_rib
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=broken_Rib_display
                        name="<span color='#DA0000'>"+_"broken rib"+"</span>"
                        description=_"Impact resistance -40%"
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    impact=40
                [/resistance]
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_broken_rib_Healing
                    description= _"Recover from broken rib"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=broken_rib_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Broken Rib" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_burned_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=burned
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=burned_display
                        name="<span color='#DA0000'>"+_"burned"+"</span>"
                        female_name="<span color='#DA0000'>"+_"female^burned"+"</span>"
                        description=_"Fire resistance -40%"
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    fire=40
                [/resistance]
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_burned_Healing
                    description= _"Recover from burn"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=burned_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Burn" {NFW_COLOR_RED}}
#enddef

# one use wound
#define NFW_captured_WOUND
    [modify_unit]
        [filter]
            {EVENT_UNIT}
            [filter_side]
                controller=human
            [/filter_side]
        [/filter]
        [object]
            id=captured_unit
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=captured_unit_display
                        name="<span color='#DA0000'>"+_"captured"+"</span>"
                        female_name="<span color='#DA0000'>"+_"female^captured"+"</span>"
                        description=_"Captured units have a increased recall cost untill you recall them once (recall+(10xlevel))."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=recall_cost
                times="per level"
                increase=10
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Capture" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_concussion_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=concussion
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=concussion_display
                        name="<span color='#DA0000'>"+_"concussed"+"</span>"
                        female_name="<span color='#DA0000'>"+_"female^concussed"+"</span>"
                        description=_"Magical damage -30%"
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=attack
                special_id=magical
                increase_damage=-30%
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_concussion_Healing
                    description= _"Recover from concussion"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=concussion_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Concussion" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_Coward_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=coward
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=coward_display
                        name="<span color='#DA0000'>"+_"coward"+"</span>"
                        female_name="<span color='#DA0000'>"+_"female^coward"+"</span>"
                        description=_"Accuracy -20%
Redeem yourself by defeating an opponent with at least 1 level higher than you or at his higher level."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=attack
                increase_accuracy=-20
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Cowardice" {NFW_COLOR_RED}}
#enddef

# only can get one, to avoid variable conflicts
#define NFW_fear_of_weapon_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=fear_of_weapon
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=nfw_scared_of_weapon
                        name="<span color='#DA0000'>"+_"weakness"+"</span>"
                        description=_"-50% strikes and -30% accuracy when facing an enemy with $second_weapon.description|.
Face your fears and defeat them to try to overcome them."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=attack
                [set_specials]
                    mode=append
                    [attacks]
                        id=nfw_scared_of_weapon_attacks
                        [filter_opponent]
                            [has_attack]
                                name=$nfwme_rand_scary_weapon
                            [/has_attack]
                        [/filter_opponent]
                        divide=2
                    [/attacks]
                    [chance_to_hit]
                        id=nfw_scared_of_weapon_chance
                        [filter_opponent]
                            [has_attack]
                                name=$nfwme_rand_scary_weapon
                            [/has_attack]
                        [/filter_opponent]
                        sub=30
                    [/chance_to_hit]
                [/set_specials]
            [/effect]
        [/object]
        [set_variable]
            name=scary_weapon
            value=$nfwme_rand_scary_weapon
        [/set_variable]
        [set_variable]
            name=scary_weapon_translated
            value=$second_weapon.description
        [/set_variable]
    [/modify_unit]

    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Scared of $second_weapon.description" {NFW_COLOR_RED}}
#enddef

# only can get one, to avoid variable conflicts
#define NFW_fear_of_type_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=fear_of_type
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=nfw_scared_of_type
                        name="<span color='#DA0000'>"+_"weakness"+"</span>"
                        description=_"-50% strikes and -30% accuracy when facing a $nfwe_second_unit_type.name|.
Face your fears and defeat them to try to overcome them."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=attack
                [set_specials]
                    mode=append
                    [attacks]
                        id=nfw_scared_of_type_attacks
                        [filter_opponent]
                            type=$nfwe_second_unit_type.id
                        [/filter_opponent]
                        divide=2
                    [/attacks]
                    [chance_to_hit]
                        id=nfw_scared_of_type_chance
                        [filter_opponent]
                            type=$nfwe_second_unit_type.id
                        [/filter_opponent]
                        sub=30
                    [/chance_to_hit]
                [/set_specials]
            [/effect]
        [/object]
        [set_variable]
            name=scary_type
            value=$nfwe_second_unit_type.id
        [/set_variable]
        [set_variable]
            name=scary_type_translated
            value=$nfwe_second_unit_type.name
        [/set_variable]
    [/modify_unit]

    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Scared of $nfwe_second_unit_type.name" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_fear_of_water_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=fear_of_water
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=fear_of_water_display
                        name="<span color='#DA0000'>"+_"aquaphobia"+"</span>"
                        description=_"Scared of water. Movement points -1 on aquatic terrains, -2 on deep waters.
Face your fears to try to overcome them."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=movement_costs
                [movement_costs]
                    reef=1
                    deep_water=2
                    shallow_water=1
                    swamp_water=1
                [/movement_costs]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Aquaphobia" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_fear_of_hight_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=fear_of_hight
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=fear_of_hight_display
                        name="<span color='#DA0000'>"+_"acrophobia"+"</span>"
                        description=_"Scared of hights. Movement points -1 on hills terrains, -2 on mountains.
Face your fears to try to overcome them."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=movement_costs
                [movement_costs]
                    mountains=2
                    hills=1
                [/movement_costs]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Acrophobia" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_fear_of_desert_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=fear_of_desert
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=fear_of_desert_display
                        name="<span color='#DA0000'>"+_"erimophobia"+"</span>"
                        description=_"Scared of deserts. Movement points -2 on frozen and sand terrains.
Face your fears to try to overcome them."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=movement_costs
                [movement_costs]
                    frozen=2
                    sand=2
                [/movement_costs]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Erimophobia" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_fear_of_cave_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=fear_of_cave
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=fear_of_cave_display
                        name="<span color='#DA0000'>"+_"claustrophobia"+"</span>"
                        description=_"Scared of tight spaces. Movement points -2 on cave terrains.
Face your fears to try to overcome them."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=movement_costs
                [movement_costs]
                    cave=2
                [/movement_costs]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Claustrophobia" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_fear_of_plant_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=fear_of_plant
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=fear_of_plant_display
                        name="<span color='#DA0000'>"+_"dendrophobia"+"</span>"
                        description=_"Scared of plants. Movement points -2 on forest and fungus terrains.
Face your fears to try to overcome them."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=movement_costs
                [movement_costs]
                    forest=2
                    fungus=2
                [/movement_costs]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Dendrophobia" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_fear_of_open_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=fear_of_open
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=fear_of_open_display
                        name="<span color='#DA0000'>"+_"agoraphobia"+"</span>"
                        description=_"Scared of open spaces. Movement points -2 on flat terrains.
Face your fears to try to overcome them."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=movement_costs
                [movement_costs]
                    flat=2
                [/movement_costs]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Agoraphobia" {NFW_COLOR_RED}}
#enddef

# non stackable and mutually exclusive with fear of light
#define NFW_fear_of_dark_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=fear_of_dark
            [effect]
                apply_to=new_ability
                [abilities]
                    [attacks]
                        name="<span color='#DA0000'>"+_"nyctophobia"+"</span>"
                        description=_"-50% strikes in the dark.
Face your fears to try to overcome them."
                        id=nfw_scared_of_dark
                        affect_self=yes
                        [filter]
                            [filter_location]
                                time_of_day=chaotic
                            [/filter_location]
                        [/filter]
                        divide=2
                    [/attacks]
                [/abilities]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Scared of the dark" {NFW_COLOR_RED}}
#enddef

# non stackable and mutually exclusive with fear of dark
#define NFW_fear_of_light_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=fear_of_light
            [effect]
                apply_to=new_ability
                [abilities]
                    [attacks]
                        name="<span color='#DA0000'>"+_"photophobia"+"</span>"
                        description=_"-50% strikes in the light.
Face your fears to try and overcome them."
                        id=nfw_scared_of_light
                        affect_self=yes
                        [filter]
                            [filter_location]
                                time_of_day=lawful
                            [/filter_location]
                        [/filter]
                        divide=2
                    [/attacks]
                [/abilities]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Scared of the light" {NFW_COLOR_RED}}
#enddef

# stackable, non dynamic, requires dedicated event to rebuild every scenario
#define NFW_fear_of_fog_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=fear_of_fog
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=fear_of_fog_display
                        name="<span color='#DA0000'>"+_"nebulaphobia"+"</span>"
                        description=_"Scared of fog. Movement points -50% when fog is enabled.
Face your fears to try to overcome them."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                [filter]
                    [filter_side]
                        formula="fog"
                    [/filter_side]
                [/filter]
                apply_to=movement
                increase=-50%
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Nebulaphobia" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_frostbite_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=frostbite
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=frostbite_display
                        name="<span color='#DA0000'>"+_"frostbite"+"</span>"
                        description=_"Cold resistance -40%"
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    cold=40
                [/resistance]
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_frostbite_Healing
                    description= _"Recover from frostbite"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=frostbite_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Frostbite" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_gash_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=gash
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=gash_display
                        name="<span color='#DA0000'>"+_"gash"+"</span>"
                        description=_"Blade resistance -40%"
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    blade=40
                [/resistance]
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_gash_Healing
                    description= _"Recover from gash"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=gash_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Gash" {NFW_COLOR_RED}}
#enddef

# non stackable
#define NFW_infection_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=infection
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=infection_display
                        name="<span color='#DA0000'>"+_"infected"+"</span>"
                        female_name="<span color='#DA0000'>"+_"female^infected"+"</span>"
                        description=_"10% chance of being poisoned every turn."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_infectiont_Healing
                    description= _"Recover from infection"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=infection_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Infection" {NFW_COLOR_RED}}
#enddef

# non stackable
#define NFW_insane_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=insanity
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=insanity_display
                        name="<span color='#DA0000'>"+_"insane"+"</span>"
                        female_name="<span color='#DA0000'>"+_"female^insane"+"</span>"
                        description=_"Melee attacks gain berserk."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=attack
                range=melee
                [set_specials]
                    mode=append
                    [berserk]
                        id=nfwme_berserk
                        name= _ "berserk"
                        description= _ "Whether used offensively or defensively, this attack presses the engagement until one of the combatants is slain, or 30 rounds of attacks have occurred."
                        special_note={INTERNAL:SPECIAL_NOTES_BERSERK}
                        value=30
                    [/berserk]
                [/set_specials]
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_insane_Healing
                    description= _"Recover from insanity"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=insane_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Insanity" {NFW_COLOR_RED}}
#enddef

# stackable, HP doesn't refill completely on advancement, but I'm going to keep it as a handicap
#define NFW_maimed_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=maimed
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=maimed_display
                        name="<span color='#DA0000'>"+_"maimed"+"</span>"
                        female_name="<span color='#DA0000'>"+_"female^maimed"+"</span>"
                        description=_"-30% HP"
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=hitpoints
                increase_total=-30%
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_maimed_Healing
                    description= _"Recover from mutilation"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=maimed_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                    [effect]
                        apply_to=hitpoints
                        heal_full=yes
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]
    # kill unit to prevent negative*negative=positive rounding
    [modify_unit]
        {FILTER_EVENT_UNIT}
        hitpoints=0
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Mutilation" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_necrosis_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=necrosis
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=necrosis_display
                        name="<span color='#DA0000'>"+_"necrotic"+"</span>"
                        female_name="<span color='#DA0000'>"+_"female^necrotic"+"</span>"
                        description=_"Arcane resistance -40%"
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    arcane=40
                [/resistance]
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_necrosis_Healing
                    description= _"Recover from necrosis"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=necrosis_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Necrosis" {NFW_COLOR_RED}}
#enddef

# stackable
#define NFW_rotten_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=necrosis
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=necrosis_display
                        name="<span color='#DA0000'>"+_"rotten"+"</span>"
                        female_name="<span color='#DA0000'>"+_"female^rotten"+"</span>"
                        description=_"Arcane and impact resistance -20%"
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    arcane=20
                    impact=20
                [/resistance]
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_necrosis_Healing
                    description= _"Recover from rot"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=necrosis_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Rot" {NFW_COLOR_RED}}
#enddef

# not stackable
#define NFW_amnesia_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=amnesia
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=amnesia_dummy
                        name="<span color='#DA0000'>"+_"amnesia"+"</span>"
                        description=_"Every round you lose 2 exp."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_amnesia_Healing
                    description= _"Recover from amnesia"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=amnesia_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Amnesia" {NFW_COLOR_RED}}
#enddef

# not stackable
#define NFW_sick_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=sick
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=sick_display
                        name="<span color='#DA0000'>"+_"sick"+"</span>"
                        female_name="<span color='#DA0000'>"+_"female^sick"+"</span>"
                        description=_"20% chance of being slowed every turn."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_sick_Healing
                    description= _"Recover from sickness"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=sick_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Sickness" {NFW_COLOR_RED}}
#enddef

# not stackable
#define NFW_wild_magic_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=wild_magic
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=wild_magic_display
                        name="<span color='#DA0000'>"+_"wild magic"+"</span>"
                        description=_"Magical attacks have a 40% chance to hit."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=attack
                special_id=magical
                remove_specials=magical
                [set_specials]
                    mode=append
                    [chance_to_hit]
                        id=magical
                        name= _ "wild magic"
                        description= _ "This attack always has a 40% chance to hit regardless of the defensive ability of the unit being attacked."
                        value=40
                        cumulative=no
                    [/chance_to_hit]
                [/set_specials]
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_wild_magic_Healing
                    description= _"Recover from wild magic"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=wild_magic_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Wild Magic" {NFW_COLOR_RED}}
#enddef

# stackable, HP doesn't refill completely on advancement, but I'm going to keep it as a handicap
#define NFW_damaged_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=damaged
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=damaged_display
                        name="<span color='#DA0000'>"+_"damaged"+"</span>"
                        female_name="<span color='#DA0000'>"+_"female^damaged"+"</span>"
                        description=_"Attack damage, movement, accuracy and HP -10%"
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=attack
                increase_damage=-10%
            [/effect]
            [effect]
                apply_to=movement
                increase=-10%
            [/effect]
            [effect]
                apply_to=hitpoints
                increase_total=-10%
            [/effect]
            [effect]
                apply_to=attack
                increase_accuracy=-10
            [/effect]
            [effect]
                apply_to=new_advancement
                [advancement]
                    id=NFW_damaged_Healing
                    description= _"Repair"
                    [effect]
                        apply_to=new_ability
                        [abilities]
                            [display]
                                id=damaged_display_healing
                            [/display]
                        [/abilities]
                    [/effect]
                [/advancement]
            [/effect]
        [/object]
    [/modify_unit]

    # kill unit to prevent negative*negative=positive rounding
    [modify_unit]
        {FILTER_EVENT_UNIT}
        hitpoints=0
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Damage" {NFW_COLOR_RED}}
#enddef

# ALL WOUNDS BELOW ARE PERMANENT, NEVER HEALS

#define NFW_paper_cut_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=paper_cut
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=paper_cut_display
                        name="<span color='#DA0000'>"+_"paper cut"+"</span>"
                        description=_"Due to the intense pain from your cut you cant concentrait on the fight.

All damage is reduced by 20% and blade resistance is lowered by 30%. You will never recover from this."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    blade=30
                [/resistance]
            [/effect]
            [effect]
                apply_to=attack
                increase_damage=-20%
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Paper Cut" {NFW_COLOR_RED}}
#enddef

#define NFW_stepped_on_lego_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [object]
            id=lego
            [effect]
                apply_to=new_ability
                [abilities]
                    [display]
                        id=lego_display
                        name="<span color='#DA0000'>"+_"lego"+"</span>"
                        description=_"Due to the intense pain of stepping on plastic brick you cant walk properly.

Movement is reduced by 20% and accuracy is reduced by 15%. You will never recover from this."
                    [/display]
                [/abilities]
            [/effect]
            [effect]
                apply_to=attack
                increase_accuracy=-15
            [/effect]
            [effect]
                apply_to=movement
                increase=-20%
            [/effect]
        [/object]
    [/modify_unit]
    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Stepped on Lego" {NFW_COLOR_RED}}
#enddef

#define NFW_TRAIT_UNDEAD
    [trait]
        id=nfw_undead
    [/trait]
#enddef

#define NFW_undead_ghost_WOUND TRAIT_UNDEAD
    [modify_unit]
        {FILTER_EVENT_UNIT}
        {TRAIT_UNDEAD}
        [trait]
            id=ghost_trait
            male_name= "<span color='#DA0000'>"+_"ghost"+"</span>"
            female_name= "<span color='#DA0000'>"+_"female^ghost"+"</span>"
            [effect]
                apply_to=image_mod
                replace=~O(40%)~B(80)
            [/effect]
            [effect]
                apply_to=alignment
                set=chaotic
            [/effect]

            # movement costs
            [effect]
                apply_to=movement_costs
                replace=yes
                [movement_costs]
                    deep_water=2
                    shallow_water=2
                    reef=2
                    swamp_water=1
                    flat=1
                    sand=1
                    forest=1
                    hills=1
                    mountains=1
                    village=1
                    castle=1
                    cave=1
                    frozen=1
                    unwalkable=1
                    fungus=1
                [/movement_costs]
            [/effect]

            # defense
            [effect]
                apply_to=defense
                replace=yes
                [defense]
                    {FLY_DEFENSE 50}
                    cave=50
                    fungus=50
                [/defense]
            [/effect]

            # resistance
            [effect]
                apply_to=resistance
                replace=yes
                [resistance]
                    blade=50
                    pierce=50
                    impact=50
                    fire=90
                    cold=30
                    arcane=110
                [/resistance]
            [/effect]

            # melee attacks
            [effect]
                apply_to=attack
                range=melee
                [not]
                    special_id=magical
                [/not]
                [not]
                    special_type=drains
                [/not]
                [not]
                    special_type=heal_on_hit
                [/not]
                [not]
                    type=cold,fire,arcane
                [/not]
                set_type=arcane
                set_description=_"spectral $unit.attack[0].description"
                set_icon=$unit.attack[0].icon
                increase_damage=-25%
                [set_specials]
                    mode=append
                    [drains]
                        id=drains
                        name= _ "drains"
                        description= _ "This unit drains health from living units, healing itself for half the amount of damage it deals (rounded down)."
                        special_note={INTERNAL:SPECIAL_NOTES_DRAIN}
                    [/drains]
                [/set_specials]
            [/effect]

            # range attacks
            [effect]
                apply_to=attack
                range=ranged
                [not]
                    special_id=magical
                [/not]
                [not]
                    type=arcane,fire,cold
                [/not]
                set_type=cold
                set_description=_"spectral $unit.attack[$($unit.attack.length - 1)].description"
                set_icon=$unit.attack[$($unit.attack.length - 1)].icon
            [/effect]

            # general damage debuff
            [effect]
                apply_to=attack
                increase_damage=-30%
            [/effect]
            # ghost health debuff
            [effect]
                apply_to=hitpoints
                increase_total=-60%
            [/effect]
        [/trait]
    [/modify_unit]

    [modify_unit]
        [filter]
            {EVENT_UNIT}
            formula="level > 1"
        [/filter]
        [effect]
            apply_to=new_advancement
            {AMLA_DEFAULT}
        [/effect]
        [set_variable]
            name=unit.advances_to
            value="null"
        [/set_variable]
    [/modify_unit]

    # kill unit to prevent negative*negative=positive rounding
    [modify_unit]
        {FILTER_EVENT_UNIT}
        hitpoints=0
    [/modify_unit]

    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Ghost" {NFW_COLOR_RED}}
#enddef

#define NFW_undead_corpse_WOUND
    [set_variable]
        name=zombie_swimming
        min=$unit.movement_costs.deep_water, 4
    [/set_variable]
    [modify_unit]
        {FILTER_EVENT_UNIT}
        # Units with trait Undead cannot be drained, poisoned, or plagued.
        {TRAIT_FEARLESS_MUSTHAVE}
        #textdomain wesnoth-help
        [trait]
            id=undead
        [/trait]
        [trait]
            id=nfwme_corpse
            male_name= "<span color='#DA0000'>"+_"undead"+"</span>"
            female_name= "<span color='#DA0000'>"+_"female^undead"+"</span>"
            description= _ "Immune to drain, poison, and plague"
            help_text= _ "<italic>text='Undead'</italic> units are immune to poison, drain, and plague."
            [effect]
                apply_to=status
                add=unpoisonable
            [/effect]
            [effect]
                apply_to=status
                add=undrainable
            [/effect]
            [effect]
                apply_to=status
                add=unplagueable
            [/effect]

            # image
            [effect]
                apply_to=image_mod
                replace=~O(30%)~GS( )
            [/effect]

            # movement
            [effect]
                apply_to=movement_costs
                replace=yes
                [movement_costs]
                    deep_water=$zombie_swimming
                [/movement_costs]
            [/effect]
            [effect]
                apply_to=movement
                increase=-30%
            [/effect]
            # resistance
            [effect]
                apply_to=resistance
                replace=yes
                [resistance]
                    arcane=140
                [/resistance]
            [/effect]
            # alignment
            [effect]
                apply_to=alignment
                set=chaotic
            [/effect]
            # melee attacks
            [effect]
                apply_to=attack
                range=melee
                [set_specials]
                    mode=append
                    [plague]
                        id=plague
                        name= _ "plague"
                        description= _ "When a unit is killed by a Plague attack, that unit is replaced with a Walking Corpse on the same side as the unit with the Plague attack. This doesnt work on Undead or units in villages."
                        special_note={INTERNAL:SPECIAL_NOTES_PLAGUE}
                        type=Walking Corpse
                    [/plague]
                [/set_specials]
            [/effect]
            # magical debuff
            [effect]
                apply_to=attack
                special_id=magical
                increase_attacks=-50%
            [/effect]
            #textdomain wesnoth-Non_Fatal_Wounds
            # marksman debuff
            [effect]
                apply_to=attack
                range=ranged
                special_id=marksman
                remove_specials=marksman
                [set_specials]
                    mode=append
                    [chance_to_hit]
                        id=marksman
                        name= _ "poor marksmanship"
                        description= _ "When used offensively, this attack always has at least a 30% chance to hit."
                        value=30
                        cumulative=yes
                        active_on=offense
                    [/chance_to_hit]
                [/set_specials]
            [/effect]
            # general damage debuff
            [effect]
                apply_to=attack
                increase_damage=-30%
            [/effect]
            # zombie health debuff
            [effect]
                apply_to=hitpoints
                increase_total=-40%
            [/effect]
        [/trait]
    [/modify_unit]
    [store_side]
        side=$unit.side
        variable=side_color
    [/store_side]
    [if]
        {VARIABLE_CONDITIONAL unit.undead_variation equals bat}
        [then]
            [modify_unit]
                {FILTER_EVENT_UNIT}
                [trait]
                    id=nfwme_corpse_image
                    [effect]
                        apply_to=overlay
                        add=units/undead/soulless-bat-se-3.png~RC(magenta>$side_color[0].color|)
                    [/effect]
                [/trait]
            [/modify_unit]
        [/then]
        [elseif]
            {VARIABLE_CONDITIONAL unit.undead_variation equals beast_rider}
            [then]
                [modify_unit]
                    {FILTER_EVENT_UNIT}
                    [trait]
                        id=nfwme_corpse_image
                        [effect]
                            apply_to=overlay
                            add=units/undead/soulless-beastrider.png~RC(magenta>$side_color[0].color|)
                        [/effect]
                    [/trait]
                [/modify_unit]
            [/then]
        [/elseif]
        [elseif]
            {VARIABLE_CONDITIONAL unit.undead_variation equals sand_scorpion}
            [then]
                [modify_unit]
                    {FILTER_EVENT_UNIT}
                    [trait]
                        id=nfwme_corpse_image
                        [effect]
                            apply_to=overlay
                            add=units/undead/soulless-scorpion.png~RC(magenta>$side_color[0].color|)
                        [/effect]
                    [/trait]
                [/modify_unit]
            [/then]
        [/elseif]
        [elseif]
            # Compare with empty var, never use nfw_empty_var as variable
            [variable]
                name=unit.undead_variation
                equals=$nfw_empty_var
            [/variable]
            [then]
                [modify_unit]
                    {FILTER_EVENT_UNIT}
                    [trait]
                        id=nfwme_corpse_image
                        [effect]
                            apply_to=overlay
                            add=units/undead/soulless.png~RC(magenta>$side_color[0].color|)
                        [/effect]
                    [/trait]
                [/modify_unit]
            [/then]
        [/elseif]
        [else]
            [modify_unit]
                {FILTER_EVENT_UNIT}
                [trait]
                    id=nfwme_corpse_image
                    [effect]
                        apply_to=overlay
                        add=units/undead/soulless-$unit.undead_variation|.png~RC(magenta>$side_color[0].color|)
                    [/effect]
                [/trait]
            [/modify_unit]
        [/else]
    [/if]

    # kill unit to prevent negative*negative=positive rounding
    [modify_unit]
        {FILTER_EVENT_UNIT}
        hitpoints=0
    [/modify_unit]

    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Zombie" {NFW_COLOR_RED}}
    {CLEAR_VARIABLE side_color}
#enddef

#define NFW_elemental_fire_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [trait]
            id=elemental
        [/trait]
        #textdomain wesnoth-help
        [trait]
            id=nfw_elemental_fire
            name="<span color='#FF6400'>"+_"elemental"+"</span>"
            female_name="<span color='#FF6400'>"+_"female^elemental"+"</span>"
            description= _ "Immune to drain, poison, and plague"
            help_text= _ "<italic>text='Elemental'</italic> units are immune to poison, drain, and plague."
            [effect]
                apply_to=status
                add=unpoisonable
            [/effect]
            [effect]
                apply_to=status
                add=undrainable
            [/effect]
            [effect]
                apply_to=status
                add=unplagueable
            [/effect]

            # image
            [effect]
                apply_to=image_mod
                replace=~CS(80,30,0)
            [/effect]
            # resistance
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    fire=-30
                [/resistance]
            [/effect]
            # fire attacks
            [effect]
                apply_to=attack
                set_type=fire
            [/effect]
            #textdomain wesnoth-Non_Fatal_Wounds
            # general damage debuff
            [effect]
                apply_to=attack
                increase_damage=-35%
            [/effect]
            # elemental health debuff
            [effect]
                apply_to=hitpoints
                increase_total=-35%
            [/effect]
        [/trait]
    [/modify_unit]

    # kill unit to prevent negative*negative=positive rounding
    [modify_unit]
        {FILTER_EVENT_UNIT}
        hitpoints=0
    [/modify_unit]

    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Fire elemental" color="255,100,0"}
#enddef

#define NFW_elemental_water_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [trait]
            id=elemental
        [/trait]
        #textdomain wesnoth-help
        [trait]
            id=nfw_elemental_water
            name="<span color='#0064FF'>"+_"elemental"+"</span>"
            female_name="<span color='#0064FF'>"+_"female^elemental"+"</span>"
            description= _ "Immune to drain, poison, and plague"
            help_text= _ "<italic>text='Elemental'</italic> units are immune to poison, drain, and plague."
            [effect]
                apply_to=status
                add=unpoisonable
            [/effect]
            [effect]
                apply_to=status
                add=undrainable
            [/effect]
            [effect]
                apply_to=status
                add=unplagueable
            [/effect]

            # image
            [effect]
                apply_to=image_mod
                replace=~CS(0,30,80)
            [/effect]
            # resistance
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    cold=-30
                [/resistance]
            [/effect]
            # cold attacks
            [effect]
                apply_to=attack
                set_type=cold
            [/effect]
            [effect]
                apply_to=attack
                remove_specials=slow
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_SLOW}
                [/set_specials]
            [/effect]
            #textdomain wesnoth-Non_Fatal_Wounds
            # general damage debuff
            [effect]
                apply_to=attack
                increase_damage=-50%
            [/effect]
            # elemental health debuff
            [effect]
                apply_to=hitpoints
                increase_total=-40%
            [/effect]
        [/trait]
    [/modify_unit]

    # kill unit to prevent negative*negative=positive rounding
    [modify_unit]
        {FILTER_EVENT_UNIT}
        hitpoints=0
    [/modify_unit]

    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Water elemental" color="0,100,255"}
#enddef

#define NFW_elemental_poison_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [trait]
            id=elemental
        [/trait]
        #textdomain wesnoth-help
        [trait]
            id=nfw_elemental_poison
            name="<span color='#00AF00'>"+_"elemental"+"</span>"
            female_name="<span color='#00AF00'>"+_"female^elemental"+"</span>"
            description= _ "Immune to drain, poison, and plague"
            help_text= _ "<italic>text='Elemental'</italic> units are immune to poison, drain, and plague."
            [effect]
                apply_to=status
                add=unpoisonable
            [/effect]
            [effect]
                apply_to=status
                add=undrainable
            [/effect]
            [effect]
                apply_to=status
                add=unplagueable
            [/effect]

            # image
            [effect]
                apply_to=image_mod
                replace=~CS(0,80,0)
            [/effect]
            # poison attacks
            [effect]
                apply_to=attack
                set_type=pierce
            [/effect]
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    pierce=-30
                [/resistance]
            [/effect]
            [effect]
                apply_to=attack
                [set_specials]
                    mode=append
                    remove_specials=poison
                    {WEAPON_SPECIAL_POISON}
                [/set_specials]
            [/effect]
            #textdomain wesnoth-Non_Fatal_Wounds
            # general damage debuff
            [effect]
                apply_to=attack
                increase_damage=-40%
            [/effect]
            # elemental health debuff
            [effect]
                apply_to=hitpoints
                increase_total=-50%
            [/effect]
        [/trait]
    [/modify_unit]

    # kill unit to prevent negative*negative=positive rounding
    [modify_unit]
        {FILTER_EVENT_UNIT}
        hitpoints=0
    [/modify_unit]

    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Poison elemental" color="0,175,0"}
#enddef

#define NFW_elemental_arcane_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [trait]
            id=elemental
        [/trait]
        #textdomain wesnoth-help
        [trait]
            id=nfw_elemental_arcane
            name="<span color='#963296'>"+_"elemental"+"</span>"
            female_name="<span color='#963296'>"+_"female^elemental"+"</span>"
            description= _ "Immune to drain, poison, and plague"
            help_text= _ "<italic>text='Elemental'</italic> units are immune to poison, drain, and plague."
            [effect]
                apply_to=status
                add=unpoisonable
            [/effect]
            [effect]
                apply_to=status
                add=undrainable
            [/effect]
            [effect]
                apply_to=status
                add=unplagueable
            [/effect]

            # image
            [effect]
                apply_to=image_mod
                replace=~CS(80,20,80)
            [/effect]
            # arcane attacks
            [effect]
                apply_to=attack
                set_type=arcane
            [/effect]
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    arcane=-30
                [/resistance]
            [/effect]
            #textdomain wesnoth-Non_Fatal_Wounds
            # general damage debuff
            [effect]
                apply_to=attack
                increase_damage=-30%
            [/effect]
            # elemental health debuff
            [effect]
                apply_to=hitpoints
                increase_total=-40%
            [/effect]
        [/trait]
    [/modify_unit]

    # kill unit to prevent negative*negative=positive rounding
    [modify_unit]
        {FILTER_EVENT_UNIT}
        hitpoints=0
    [/modify_unit]

    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Arcane elemental" color="150,50,150"}
#enddef

#define NFW_elemental_earth_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [trait]
            id=elemental
        [/trait]
        #textdomain wesnoth-help
        [trait]
            id=nfw_elemental_earth
            name="<span color='#7D3C00'>"+_"elemental"+"</span>"
            female_name="<span color='#7D3C00'>"+_"female^elemental"+"</span>"
            description= _ "Immune to drain, poison, and plague"
            help_text= _ "<italic>text='Elemental'</italic> units are immune to poison, drain, and plague."
            [effect]
                apply_to=status
                add=unpoisonable
            [/effect]
            [effect]
                apply_to=status
                add=undrainable
            [/effect]
            [effect]
                apply_to=status
                add=unplagueable
            [/effect]

            # image
            [effect]
                apply_to=image_mod
                replace=~CS(60,60,0)
            [/effect]
            # earth attacks
            [effect]
                apply_to=attack
                set_type=impact
            [/effect]
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    impact=-30
                [/resistance]
            [/effect]
            [effect]
                apply_to=movement
                increase=-20%
            [/effect]
            #textdomain wesnoth-Non_Fatal_Wounds
            # general damage debuff
            [effect]
                apply_to=attack
                increase_damage=-25%
            [/effect]
            # elemental health debuff
            [effect]
                apply_to=hitpoints
                increase_total=-30%
            [/effect]
        [/trait]
    [/modify_unit]

    # kill unit to prevent negative*negative=positive rounding
    [modify_unit]
        {FILTER_EVENT_UNIT}
        hitpoints=0
    [/modify_unit]

    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Earth elemental" color="125,60,0"}
#enddef

#define NFW_elemental_air_WOUND
    [modify_unit]
        {FILTER_EVENT_UNIT}
        [trait]
            id=elemental
        [/trait]
        #textdomain wesnoth-help
        [trait]
            id=nfw_elemental_air
            name="<span color='#00FFFF'>"+_"elemental"+"</span>"
            female_name="<span color='#00FFFF'>"+_"female^elemental"+"</span>"
            description= _ "Immune to drain, poison, and plague"
            help_text= _ "<italic>text='Elemental'</italic> units are immune to poison, drain, and plague."
            [effect]
                apply_to=status
                add=unpoisonable
            [/effect]
            [effect]
                apply_to=status
                add=undrainable
            [/effect]
            [effect]
                apply_to=status
                add=unplagueable
            [/effect]

            # image
            [effect]
                apply_to=image_mod
                replace=~O(40%)~CS(0,100,100)
            [/effect]
            # earth attacks
            [effect]
                apply_to=attack
                set_type=blade
            [/effect]
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    blade=-40
                    pierce=-20
                    impact=-20
                [/resistance]
            [/effect]
            [effect]
                apply_to=movement
                increase=30%
            [/effect]
            #textdomain wesnoth-Non_Fatal_Wounds
            # general damage debuff
            [effect]
                apply_to=attack
                increase_damage=-40%
            [/effect]
            # elemental health debuff
            [effect]
                apply_to=hitpoints
                increase_total=-60%
            [/effect]
        [/trait]
    [/modify_unit]

    # kill unit to prevent negative*negative=positive rounding
    [modify_unit]
        {FILTER_EVENT_UNIT}
        hitpoints=0
    [/modify_unit]

    {NFW_FLOAT_TEXT_CONDITIONAL $x1 $y1 _"Air elemental" color="0,255,255"}
#enddef
